<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>DLL injection - Developing a simple injector. | 801 Labs</title><meta name="description" content="description"/><link rel="canonical" href="https://www.801labs.org/research-portal/post/developing-a-dll-injector"/><link rel="icon" href="/favicon.png" sizes="16x16"/><meta property="og:title" content="DLL injection - Developing a simple injector. | 801 Labs"/><meta property="og:description" content="801 Labs is a Salt Lake City based hackerspace created by local information technology, electronics, and information security enthusiasts."/><meta property="og:image" content="https://www.801labs.org2019/07/process-explorer-test-dll-injection-success.png"/><meta property="og:url" content="https://www.801labs.org/research-portal/post/developing-a-dll-injector"/><meta property="og:site_name" content="801 Labs"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@801Labs"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="theme-color" content="#6bf0c2"/><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,700;0,900;1,400&amp;family=Tomorrow:wght@400;600;700&amp;display=swap" rel="stylesheet"/><meta name="google-site-verification" content="QnlAT_0caLTAeL1e8V-RlHWBX7xauM_CnxY_5-ltIF4"/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/d5d1566a322207c0da33.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d5d1566a322207c0da33.css"/><link rel="preload" href="/_next/static/chunks/main-b4e92501dafbf3105fc2.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-488dc228921f1fdbc0e7.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.639a4c6d2372edf94622.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.4d1825a506d17b0928b0.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-badc504270fd7076183e.js" as="script"/><link rel="preload" href="/_next/static/chunks/cb1608f2.7e132185cf1e34346bef.js" as="script"/><link rel="preload" href="/_next/static/chunks/a9a7754c.d19ee79fa77cd467a6a8.js" as="script"/><link rel="preload" href="/_next/static/chunks/d08d8da065e662efb4cb4dbcdc52896f9ea60d65.0dcfe3fd2994d62f05b2.js" as="script"/><link rel="preload" href="/_next/static/chunks/269ea3ef5216fdb5e29fe1b24ee03a8936e3d31a.2c1f7a57d2a5886c4934.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/research-portal/post/%5Bslug%5D-4f135702a487b59705c4.js" as="script"/></head><body><div id="__next"><div class="bg-white font-sans fluid-text-base"><div class="fixed inset-0 z-40 bg-graphite-800 hidden" style="--bg-opacity:0.4"></div><div class="fixed right-0 top-0 h-screen overflow-y-auto z-50 w-full sm:w-64 font-display bg-graphite-800 text-white hidden"><div class="px-5 pt-5 text-right"><button class="px-4 py-2" title="Close Menu"><span class="sr-only">Close Menu</span><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11 fa-lg " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg></button></div><ul class="pt-2 pb-5 fluid-text-lg"><li><a class="py-1 px-5 link--white" href="/about/">About</a><ul class="fluid-text-base"><li><a class="py-1 pl-10 pr-5 link--white" href="/about/financial-information/">Financial Information</a></li><li><a class="py-1 pl-10 pr-5 link--white" href="/about/news/1/">News</a></li></ul></li><li><a class="py-1 px-5 link--white" href="/research-portal/1/">Learn</a></li><li><a class="py-1 px-5 link--white" href="/get-involved/">Get Involved</a><ul class="fluid-text-base"><li><a class="py-1 pl-10 pr-5 link--white" href="/get-involved/events/">Events</a></li><li><a class="py-1 pl-10 pr-5 link--white" href="/get-involved/location-and-hours/">Location and Hours</a></li></ul></li><li><a class="py-1 px-5 link--white" href="/contact/">Contact Us</a></li><li><a class="py-1 px-5 link--tangerine font-bold" href="/donate/">DonateÂ &gt;</a></li></ul></div><div class="page"><header class="page-header font-display bg-graphite-800 text-white"><div class="container mx-auto px-5 lg:px-10 xl:px-16 py-3 lg:py-5 flex"><div class="flex-initial"><a class="text-white" href="/"><svg xmlns="http://www.w3.org/2000/svg" class="fill-current" viewBox="0 0 1566.7 420.9" width="217"><title>801 Labs - a Community Hackerspace</title><path d="M131.5 261.8h24.1c1.8 0 3.2 1.5 3.2 3.2 0 1.8-1.5 3.2-3.2 3.2h-24.1c-1.8 0-3.2-1.5-3.2-3.2-.1-1.8 1.4-3.2 3.2-3.2z"></path><path d="M194.9 148.8V60.9c13-4.1 21.9-16.1 21.9-29.8 0-17.2-14-31.2-31.2-31.2h-85.3c-13.6.1-25.7 9-29.7 22-5.1 16.4 4.1 33.9 20.5 39v87.8c-7.5 2.9-14.8 6.5-21.7 10.6-67.6 40.6-89.6 128.2-49.1 195.8 12.9 21.3 31 39.1 52.6 51.6 18.4 10.7 29.7 12.9 32.7 13.4 12.1 1.7 22.7-1.3 30.5-8.8 9.3-8.8 14.9-23.7 16.6-44.2.6-8.6.7-17.3.3-25.9 3.6-2.4 6.3-6.1 7.3-10.7l.3-1.2c0-.6.1-1.5.1-2.4h16c6.3 0 11.5-5.1 11.5-11.4v-.9h-.2c.1-.6.2-1.2.2-1.7l.2-34.4c0-1.5-1.2-2.6-2.6-2.6h-1.2c-1.5 0-2.6-1.2-2.6-2.7l.1-39.6c0-1.4-1.2-2.6-2.6-2.6l-71.7-.2c-1.4 0-2.6 1.2-2.6 2.6l-.1 39.6c0 1.4-1.2 2.6-2.6 2.6h-1.2c-1.4 0-2.6 1.2-2.6 2.6l-.1 34.6c0 .6.1 1.3.2 1.9h-.2v.7c0 6.3 5.1 11.5 11.4 11.5h16.3c.1.8.4 1.6.6 2.4 0 0 3.3 8.8 9.1 12.8 1 22.2-.7 46.7-11.5 56.8-4.1 3.9-9.4 5.3-16.5 4.3-.4-.1-9.7-1.5-26.5-11.2-19.1-11-35.1-26.7-46.5-45.6-3.5-5.8-6.5-11.9-9-18.2-25.6-64.5 6-137.5 70.4-163.1 2-.8 11.7-5.7 11.7-11.3V54.2v-.6c0-4.6-3.7-8.2-8.2-8.2-7.8-.1-14-6.6-13.9-14.4.1-7.8 6.6-14 14.4-13.9h85.3c7.8-.1 14.2 6.1 14.4 13.9.1 7.8-6.1 14.2-13.9 14.4h-.6c-4.5.3-7.9 4.3-7.6 8.9v99.5c0 5.9 9.8 10.6 11.7 11.3 47.9 19.1 79.3 65.5 79.3 117 0 57.5-38.5 107.7-93.5 122.1-3.7 1-6.3 4.4-6.3 8.2 0 4.7 3.8 8.5 8.5 8.5.7 0 1.5-.1 2.2-.2 62.5-16.4 106.2-73.4 106.2-138.6-.1-59-36.3-111.9-91.2-133.3zm-62.8 155.4l-1.6 7.7c-.4 1.5-1.7 2.5-3.2 2.5l-13.4-.3c-1.5 0-2.6-1.2-2.6-2.7V291c0-1.4 1.2-2.6 2.6-2.6h1.2c1.4 0 2.6-1.2 2.6-2.6l.1-39.6c0-1.4 1.2-2.6 2.6-2.6h5.4c1.4 0 2.6 1.2 2.6 2.6v7.6c0 1.5 1.2 2.6 2.6 2.6h1.2c1.4 0 2.6-1.2 2.6-2.6v-7.3c0-1.4 1.2-2.6 2.6-2.7l11.9-.1c1.4.1 2.5 1.2 2.5 2.6v7.5c0 1.4 1.2 2.6 2.6 2.6h1.3c1.4 0 2.6-1.2 2.6-2.6v-7.6c0-1.4 1.2-2.6 2.6-2.6h5.3c1.5 0 2.7 1.1 2.7 2.6v.1l-.1 39.6c0 1.5 1.2 2.6 2.6 2.6h1.2c1.5 0 2.6 1.2 2.6 2.6v20.4c0 1.4-1.2 2.6-2.6 2.6h-13.4c-1.5-.1-2.8-1.1-3.1-2.6l-1.6-7.7c-.4-1.5-1.6-2.5-3.1-2.5l-16.4.2c-1.2.2-2.5 1.2-2.9 2.7z"></path><path d="M453.1 366.9c-40 0-64.9-24.1-64.9-59.7v-30c-.9-17 8.3-32.9 23.3-40.8-14.1-6.3-23-21.5-23-40.8v-26.9c0-35.6 24.5-59.7 64.5-59.7s64.9 24.1 64.9 59.7v26.9c0 19.3-8.9 34.5-23 40.8 15.2 7.8 24.4 23.7 23.7 40.8v30c.1 35.7-25.1 59.7-65.5 59.7zm23.7-196.5c-.6-13-11.7-23-24.7-22.4-12.1.6-21.8 10.3-22.4 22.4V203c1.1 13 12.5 22.7 25.5 21.6 11.5-1 20.6-10.1 21.6-21.6v-32.6zm.4 100.4c0-11.5-8.2-21.9-24.1-21.9-11.8-1-22.3 7.8-23.3 19.6-.1.8-.1 1.5-.1 2.3v34.5c-.7 12.2 8.7 22.7 20.9 23.3h2.4c12.4.8 23.2-8.6 24.1-21 .1-.8.1-1.5 0-2.3v-34.5zM630.3 366.9c-40 0-65.6-25.9-65.6-64.1V173.7c0-38.6 25.5-64.1 65.6-64.1 40.1 0 66 25.5 66 64.1v129.1c-.1 38.2-25.6 64.1-66 64.1zM654 170.1c0-11.9-8.9-21.5-23.7-21.5-11.8-1-22.3 7.8-23.3 19.6-.1.6-.1 1.3-.1 1.9v135.7c0 11.9 9.6 21.6 21.4 21.6.6 0 1.3 0 1.9-.1 14.8 0 23.7-9.6 23.7-21.5V170.1zM753.7 361.4V134.2c14.1 0 19.3-9.3 19.3-19.6h23.3v246.8h-42.6zM930.6 361.4V114.5h45.9v206.1h69v40.8H930.6zM1174.8 361.4l-8.2-48.4h-43.7l-8.9 48.4h-43l49.6-246.8h51.5l49.5 246.8h-46.8zm-28.9-180.2l-16.7 95.3h31.5l-14.8-95.3zM1335.3 361.4h-77.8V114.5h77.2c33.7 0 54.5 18.2 54.5 52.3v26.9c0 21.1-8.2 37.1-29.3 41.5 22.2 5.9 30.4 21.1 30.4 41.9v32.3c-.2 34.2-21.3 52-55 52zm9.6-191.3c0-11.1-4.8-17.8-16.1-17.8h-24.9v67.8h23c11.9 0 18.2-6.3 18.2-19.3l-.2-30.7zm.7 103.5c0-13-6.3-19.6-18.2-19.6h-23.7v69.9h25.9c11.5 0 16.1-6.3 16.1-17.8l-.1-32.5zM1498.4 366.9c-42.3 0-68.6-25.2-68.6-63.7v-17.1h42.3v14.5c0 18.2 8.5 28.2 25.2 28.2s24.5-9.6 24.5-24.9c0-19.6-12.6-33-37.1-51.2-24.5-18.2-52.6-42.6-52.6-77.1 0-35.6 23-66.3 67.5-66.3 38.9 0 64.9 26.9 64.9 63.4v16.1h-41.9V174c0-15.2-7.8-26.3-23.3-26.3-11.5-.8-21.4 7.8-22.2 19.3-.1 1-.1 1.9 0 2.9 0 20.8 12.2 31.5 39.6 51.5 29.3 21.9 50 44.1 50 77.5-.2 39.5-27.7 68-68.3 68z"></path></svg></a></div><div class="lg:hidden flex-1 text-right"><button class="px-4 py-2" title="Toggle Menu"><span class="sr-only">Toggle Menu</span><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars fa-w-14 fa-lg " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></button></div><ul class="flex-1 hidden lg:flex justify-end fluid-text-lg"><li class="group relative"><a class="p-3 link--white" href="/about/">About</a><ul class="hidden group-focus-within:block group-hover:block py-2 absolute left-0 w-64 bg-graphite-800 fluid-text-base"><li><a class="block py-1 px-5 link--white" href="/about/financial-information/">Financial Information</a></li><li><a class="block py-1 px-5 link--white" href="/about/news/1/">News</a></li></ul></li><li class="group relative"><a class="p-3 link--white" href="/research-portal/1/">Learn</a></li><li class="group relative"><a class="p-3 link--white" href="/get-involved/">Get Involved</a><ul class="hidden group-focus-within:block group-hover:block py-2 absolute left-0 w-64 bg-graphite-800 fluid-text-base"><li><a class="block py-1 px-5 link--white" href="/get-involved/events/">Events</a></li><li><a class="block py-1 px-5 link--white" href="/get-involved/location-and-hours/">Location and Hours</a></li></ul></li><li class="group relative"><a class="p-3 link--white" href="/contact/">Contact Us</a></li><li class="group relative"><a class="p-3 link--tangerine font-bold" href="/donate/">DonateÂ &gt;</a></li></ul></div></header><main class="page-content"><div class="bg-graphite-900 bg-image-grid bg-top text-white"><div class="container-1400 mx-auto px-5 py-20 text-center"><h2 class="h1 text-shadow-glow">801 Labs Research Portal</h2></div></div><div class="container-1400 mx-auto px-5 py-20 md:flex md:space-x-20"><aside class="hidden md:block md:w-1/4"><div><h3 class="fluid-text-lg font-bold bg-black text-white px-5 py-1 mb-3">Tags</h3><ul class="px-5 py-1 space-y-2"><li><a href="/research-portal/tag/biohacking/1/">biohacking</a></li><li><a href="/research-portal/tag/buffer-overflow/1/">buffer overflow</a></li><li><a href="/research-portal/tag/development/1/">Development</a></li><li><a href="/research-portal/tag/dll-injection/1/">DLL Injection</a></li><li><a href="/research-portal/tag/domains/1/">domains</a></li><li><a href="/research-portal/tag/ee/1/">EE</a></li><li><a href="/research-portal/tag/example/1/">example</a></li><li><a href="/research-portal/tag/how-to/1/">how to</a></li><li><a href="/research-portal/tag/makefile/1/">Makefile</a></li><li><a href="/research-portal/tag/memory/1/">memory</a></li><li><a href="/research-portal/tag/pcap/1/">pcap</a></li><li><a href="/research-portal/tag/phishing/1/">phishing</a></li><li><a href="/research-portal/tag/re/1/">RE</a></li><li><a href="/research-portal/tag/research/1/">research</a></li><li><a href="/research-portal/tag/rfid/1/">RFID</a></li><li><a href="/research-portal/tag/story/1/">Story</a></li><li><a href="/research-portal/tag/windows-api/1/">Windows API</a></li><li><a href="/research-portal/tag/windows-hacking/1/">Windows Hacking</a></li></ul></div></aside><div class="md:w-3/4"><h1 class="h2 mb-10">DLL injection - Developing a simple injector.</h1><img loading="lazy" src="/_next/static/images/process-explorer-test-dll-injection-success-320-4c3ea14f721f498145f270602b4fb293.png" sizes="(min-width: 960px) 960px, 100vw" alt="DLL injection - Developing a simple injector." class="mb-8 mx-auto max-h-100" srcSet="/_next/static/images/process-explorer-test-dll-injection-success-320-4c3ea14f721f498145f270602b4fb293.png 320w,/_next/static/images/process-explorer-test-dll-injection-success-640-ccf24fee1f07f598aa51e21babc83f48.png 640w,/_next/static/images/process-explorer-test-dll-injection-success-787-24f050b26483fbdde8070ee31259b7d5.png 787w" width="787" height="586" style="max-width:min(100%, 787px)"/><div class="space-y-6 markdown"><p><a href="https://en.wikipedia.org/wiki/DLL_injection">DLL injection</a> is the process of forcing a running process to load a DLL (Dynamically Linked Library) of your choice. In this write-up, I'll walk you through the LoadLibraryA injection method. This causes the DLL to be loaded into the context of the process thus allowing us to execute our own code inside of the process's virtual memory space.</p>
<pre><code>I assume there is a base understanding of what a DLL is. By the end of this write-up, we'll have a functional DLL injector along with a bare-bone test DLL which we'll use for testing during development.

Writing a DLL injector is pretty trivial and only requires a handful steps. Remember that DLLs are specific to Windows and there-for we'll be utilizing functions provided to us by the Windows API. The steps required for the task at hand are in order as follows:
</code></pre>
<ol>
<li>Acquire a handle to the remote process that you want to inject / load your DLL into. We do this by prompting for a process ID (PID) after displaying a list of processes w/ their PIDs.</li>
</ol>
<pre><code>// Get the remote target pid
uint16_t target_pid = get_target_pid();

if (!target_pid) {
std::cerr &#x3C;&#x3C; "Getting remote target process ID failed..." &#x3C;&#x3C; std::endl;
return 1;
}

// &#x3C;snipped> ...

// Obtain a handle to the target remote process.
HANDLE target_process = OpenProcess(PROCESS_ALL_ACCESS, FALSE, target_pid);


if (target_process == NULL) {
    std::cerr &#x3C;&#x3C; "Acquiring a handle to the remote target process failed..." &#x3C;&#x3C; std::endl;
    return -1;
}
</code></pre>
<p><em>get_target_pid() function:</em></p>
<pre><code>uint16_t get_target_pid() {
    uint16_t pid = 0;
    
    std::string pid_str;
    bool first_input_entered = false;

    do {
        if (first_input_entered) {
            system("cls");
            print_banner();
            std::cerr &#x3C;&#x3C; "The given process ID is invalid, try again..." &#x3C;&#x3C; std::endl;
        }

        print_process_list();

        std::cout &#x3C;&#x3C; "\nEnter target process ID: ";
        std::getline(std::cin, pid_str);

        if (first_input_entered == false) {
            first_input_entered = true;
        }

        if (pid_str == "exit" ||
            pid_str == "quit") {
            break;
        }

    } while (file_exists(pid_str) == false &#x26;&#x26; !pid_str.size());

    if (pid_str != "exit" &#x26;&#x26;
        pid_str != "quit") {
        pid = (uint16_t)std::stoi(pid_str);
    }

    return pid;
}
</code></pre>
<ol start="2">
<li>Create and store the DLL's absolute path in a variable.</li>
</ol>
<pre><code>// Get the dll's path that we want to inject into our remote target process.
std::string dll_path = get_dll_path();

std::cout &#x3C;&#x3C; "DLL path: " &#x3C;&#x3C; dll_path &#x3C;&#x3C; std::endl;
</code></pre>
<p><em>get_dll_path() function:</em></p>
<pre><code>std::string get_dll_path() {

    std::string dll_path;
    bool first_input_entered = false;

    do {
        if (first_input_entered) {
            system("cls");
            print_banner();
            std::cerr &#x3C;&#x3C; "Specified DLL path was invalid, try again..." &#x3C;&#x3C; std::endl;
        }

        std::cout &#x3C;&#x3C; "Enter path to DLL: ";
        std::getline(std::cin, dll_path);

        if (first_input_entered == false) {
            first_input_entered = true;
        }

        if (dll_path == "exit" ||
            dll_path == "quit") {
            break;
        }

    } while (file_exists(dll_path) == false);

    return dll_path;
}
</code></pre>
<ol start="3">
<li>Now we need to allocate enough space in the remote process to store the DLLs absolute path. We achieve this by using Window's <a href="https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualallocex">VirtualAllocEx</a> function.</li>
</ol>
<pre><code>// Allocate space for our DLL path inside the target remote process.
LPVOID dll_path_in_remote_mem_addr = VirtualAllocEx(
    target_process,
    NULL,
    _MAX_PATH,
    MEM_RESERVE | MEM_COMMIT,
    PAGE_EXECUTE_READWRITE
);

if (dll_path_in_remote_mem_addr == NULL) {
    std::cerr &#x3C;&#x3C; "Allocating space for our DLL path in the remote target process's virtual memory space failed..." &#x3C;&#x3C; std::endl;
    CloseHandle(target_process);
    return 1;
}

std::cout &#x3C;&#x3C; "DLL allocation memory address: " &#x3C;&#x3C; &#x26;dll_path_in_remote_mem_addr &#x3C;&#x3C; std::endl;
</code></pre>
<ol start="4">
<li>And now that we've allocated and reserved enough memory for the DLL path, we can write it into that region of memory of the remote process using the Window's <a href="https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-writeprocessmemory">WriteProcessMemory</a> function. </li>
</ol>
<pre><code>// Copy the DLL path into the allocated memory region.
bool write_status = WriteProcessMemory(
    target_process,
    dll_path_in_remote_mem_addr,
    dll_path.c_str(),
    strlen(dll_path.c_str()),
    NULL
);

std::cout &#x3C;&#x3C; "WriteProcessMemory was " &#x3C;&#x3C; (write_status ? "successful!" : "unsuccessful...") &#x3C;&#x3C; std::endl;;

if (!write_status) {
    std::cerr &#x3C;&#x3C; "GetLastError() for failed WriteProcessMemory() call: " &#x3C;&#x3C; GetLastError() &#x3C;&#x3C; std::endl;
    CloseHandle(target_process);
    return 1;
}
</code></pre>
<ol start="5">
<li>Next, we'll need to obtain the address to the Window's <a href="https://docs.microsoft.com/en-us/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya">LoadLibraryA</a> function. This is easily done through the Window's <a href="https://docs.microsoft.com/en-us/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress">GetProcAddress</a> function.</li>
</ol>
<pre><code>// Get the address to the LoadLibraryA Windows API function.
LPVOID load_library_addr = (LPVOID)GetProcAddress(
    GetModuleHandle("kernel32.dll"),
    "LoadLibraryA"
);

if (load_library_addr == NULL) {
    std::cerr &#x3C;&#x3C; "GetProcAddress failed..." &#x3C;&#x3C; std::endl;
    CloseHandle(target_process);
    return 1;
}

std::cout &#x3C;&#x3C; "LoadLibraryA address: " &#x3C;&#x3C; &#x26;load_library_addr &#x3C;&#x3C; std::endl;
</code></pre>
<ol start="6">
<li>Create a remote thread via <a href="https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createremotethread">CreateRemoteThread</a> and pass the handle we have on the remote process, the address to LoadLibraryA, and the memory address that our DLL path resides at. LoadLibraryA will be invoked and passed <code>dll_path_in_remote_mem_addr</code> by our call to CreateRemoteThread. This is where the magic happens and our DLL is loaded into the process.</li>
</ol>
<pre><code>// Create our remote thread for running our DLL code.
HANDLE remote_thread = CreateRemoteThread(
    target_process,
    NULL,
    NULL,
    (LPTHREAD_START_ROUTINE)load_library_addr,
    dll_path_in_remote_mem_addr,
    NULL,
    NULL
);

if (remote_thread == NULL) {
    std::cerr &#x3C;&#x3C; "CreateRemoteThread failed..." &#x3C;&#x3C; std::endl;
    return 1;
}

std::cout &#x3C;&#x3C; "Remote thread address: " &#x3C;&#x3C; &#x26;remote_thread &#x3C;&#x3C; std::endl;
</code></pre>
<ol start="7">
<li>The last thing we do is deallocate the memory that was reserved for our DLL path using <a href="https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualfreeex">VirtualFreeEx</a> and then close our open handles using <a href="https://docs.microsoft.com/en-us/windows/desktop/api/handleapi/nf-handleapi-closehandle">CloseHandle</a>.</li>
</ol>
<pre><code>// Release the allocated memory we acquired from the remote process.
if (VirtualFreeEx(target_process, dll_path_in_remote_mem_addr, 0, MEM_RELEASE) == 0) {
    std::cerr &#x3C;&#x3C; "VirtualFreeEx failed on target process..." &#x3C;&#x3C; std::endl;
}

// Free our handle on the remote thread
CloseHandle(remote_thread);

// Free our handle on the remote process
CloseHandle(target_process);
</code></pre>
<p>Tying our code together and testing it out ~ we run <code>.\InjectDLL.exe</code>, then enter the remote target PID, and finally the absolute path to <code>TestDLL.dll</code>. Our executable outputs some information about the injection indicating it was successful. Â </p>
<figure><img src="/_next/static/images/2019-05-02-090559_3440x1440_scrot-320-74045b2d21363f7d7b94d37e5fb53583.png" srcset="/_next/static/images/2019-05-02-090559_3440x1440_scrot-320-74045b2d21363f7d7b94d37e5fb53583.png 320w,/_next/static/images/2019-05-02-090559_3440x1440_scrot-640-df94f6e33fddaea1d71f1c60adbdd6d0.png 640w,/_next/static/images/2019-05-02-090559_3440x1440_scrot-858-3205627f11b561f2c89b5a4764c65e8d.png 858w" sizes="(min-width: 960px) 960px, 100vw" width="858" height="652" alt="undefined" loading="lazy" /><figcaption>Successful execution of our DLL injector</figcaption></figure>
<p>Our injector indicated it was successful, but we can double check with Window's <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer">Process Explorer</a>. After installing it (if you don't have it installed already) we launch it, make sure the lower pane is visible by toggling it on. This can be achieved by checking the <code>View -> Show Lower Pane</code> option. Then, select the remote target process in the list and press the key combination <code>Ctrl + d</code>. You should now see a list of loaded DLLs. One of which is our DLL! </p>
<figure><img src="/_next/static/images/process-explorer-test-dll-injection-success-320-4c3ea14f721f498145f270602b4fb293.png" srcset="/_next/static/images/process-explorer-test-dll-injection-success-320-4c3ea14f721f498145f270602b4fb293.png 320w,/_next/static/images/process-explorer-test-dll-injection-success-640-ccf24fee1f07f598aa51e21babc83f48.png 640w,/_next/static/images/process-explorer-test-dll-injection-success-787-24f050b26483fbdde8070ee31259b7d5.png 787w" sizes="(min-width: 960px) 960px, 100vw" width="787" height="586" alt="undefined" loading="lazy" /><figcaption>Using Process Explorer, we can see that our TestDLL.dll file was injected into Game.exe successfully.</figcaption></figure>
<p>Once we have successfully loaded our DLL into the target process, we can access and reference anything within it's virtual memory space. In part 2, I'll demonstrate an example use case of DLL injection by showing how we can find an in-memory data structure (i.e. the offset to a player structure / class in a game).</p>
<p>The full source code for both the DLL injector and the Test DLL can be found in this <a href="https://github.com/selftaught/DLLinjector">Github</a> repository.</p>
<p>Thanks for reading through this article! If you notice any issues in the write-up or code - please don't hesitate to message me! You can do so via <a href="https://keybase.io/th3v0id">keybase</a> or <a href="https://twitter.com/x74x76">twitter</a>.</p>
</div></div></div></main><footer class="page-footer bg-lime-900 text-white pt-10 pb-16"><div class="container-1200 mx-auto px-5"><ul class="flex flex-wrap justify-center mb-10"><li class="m-3"><a class="link--white" href="https://www.meetup.com/801labs/" rel="noopener" target="_blank" title="Meetup"><span class="sr-only">Meetup</span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="meetup" class="svg-inline--fa fa-meetup fa-w-16 fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M99 414.3c1.1 5.7-2.3 11.1-8 12.3-5.4 1.1-10.9-2.3-12-8-1.1-5.4 2.3-11.1 7.7-12.3 5.4-1.2 11.1 2.3 12.3 8zm143.1 71.4c-6.3 4.6-8 13.4-3.7 20 4.6 6.6 13.4 8.3 20 3.7 6.3-4.6 8-13.4 3.4-20-4.2-6.5-13.1-8.3-19.7-3.7zm-86-462.3c6.3-1.4 10.3-7.7 8.9-14-1.1-6.6-7.4-10.6-13.7-9.1-6.3 1.4-10.3 7.7-9.1 14 1.4 6.6 7.6 10.6 13.9 9.1zM34.4 226.3c-10-6.9-23.7-4.3-30.6 6-6.9 10-4.3 24 5.7 30.9 10 7.1 23.7 4.6 30.6-5.7 6.9-10.4 4.3-24.1-5.7-31.2zm272-170.9c10.6-6.3 13.7-20 7.7-30.3-6.3-10.6-19.7-14-30-7.7s-13.7 20-7.4 30.6c6 10.3 19.4 13.7 29.7 7.4zm-191.1 58c7.7-5.4 9.4-16 4.3-23.7s-15.7-9.4-23.1-4.3c-7.7 5.4-9.4 16-4.3 23.7 5.1 7.8 15.6 9.5 23.1 4.3zm372.3 156c-7.4 1.7-12.3 9.1-10.6 16.9 1.4 7.4 8.9 12.3 16.3 10.6 7.4-1.4 12.3-8.9 10.6-16.6-1.5-7.4-8.9-12.3-16.3-10.9zm39.7-56.8c-1.1-5.7-6.6-9.1-12-8-5.7 1.1-9.1 6.9-8 12.6 1.1 5.4 6.6 9.1 12.3 8 5.4-1.5 9.1-6.9 7.7-12.6zM447 138.9c-8.6 6-10.6 17.7-4.9 26.3 5.7 8.6 17.4 10.6 26 4.9 8.3-6 10.3-17.7 4.6-26.3-5.7-8.7-17.4-10.9-25.7-4.9zm-6.3 139.4c26.3 43.1 15.1 100-26.3 129.1-17.4 12.3-37.1 17.7-56.9 17.1-12 47.1-69.4 64.6-105.1 32.6-1.1.9-2.6 1.7-3.7 2.9-39.1 27.1-92.3 17.4-119.4-22.3-9.7-14.3-14.6-30.6-15.1-46.9-65.4-10.9-90-94-41.1-139.7-28.3-46.9.6-107.4 53.4-114.9C151.6 70 234.1 38.6 290.1 82c67.4-22.3 136.3 29.4 130.9 101.1 41.1 12.6 52.8 66.9 19.7 95.2zm-70 74.3c-3.1-20.6-40.9-4.6-43.1-27.1-3.1-32 43.7-101.1 40-128-3.4-24-19.4-29.1-33.4-29.4-13.4-.3-16.9 2-21.4 4.6-2.9 1.7-6.6 4.9-11.7-.3-6.3-6-11.1-11.7-19.4-12.9-12.3-2-17.7 2-26.6 9.7-3.4 2.9-12 12.9-20 9.1-3.4-1.7-15.4-7.7-24-11.4-16.3-7.1-40 4.6-48.6 20-12.9 22.9-38 113.1-41.7 125.1-8.6 26.6 10.9 48.6 36.9 47.1 11.1-.6 18.3-4.6 25.4-17.4 4-7.4 41.7-107.7 44.6-112.6 2-3.4 8.9-8 14.6-5.1 5.7 3.1 6.9 9.4 6 15.1-1.1 9.7-28 70.9-28.9 77.7-3.4 22.9 26.9 26.6 38.6 4 3.7-7.1 45.7-92.6 49.4-98.3 4.3-6.3 7.4-8.3 11.7-8 3.1 0 8.3.9 7.1 10.9-1.4 9.4-35.1 72.3-38.9 87.7-4.6 20.6 6.6 41.4 24.9 50.6 11.4 5.7 62.5 15.7 58.5-11.1zm5.7 92.3c-10.3 7.4-12.9 22-5.7 32.6 7.1 10.6 21.4 13.1 32 6 10.6-7.4 13.1-22 6-32.6-7.4-10.6-21.7-13.5-32.3-6z"></path></svg></a></li><li class="m-3"><a class="link--white" href="https://discord.com/Un3gXVs" rel="noopener" target="_blank" title="Discord"><span class="sr-only">Discord</span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="discord" class="svg-inline--fa fa-discord fa-w-14 fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M297.216 243.2c0 15.616-11.52 28.416-26.112 28.416-14.336 0-26.112-12.8-26.112-28.416s11.52-28.416 26.112-28.416c14.592 0 26.112 12.8 26.112 28.416zm-119.552-28.416c-14.592 0-26.112 12.8-26.112 28.416s11.776 28.416 26.112 28.416c14.592 0 26.112-12.8 26.112-28.416.256-15.616-11.52-28.416-26.112-28.416zM448 52.736V512c-64.494-56.994-43.868-38.128-118.784-107.776l13.568 47.36H52.48C23.552 451.584 0 428.032 0 398.848V52.736C0 23.552 23.552 0 52.48 0h343.04C424.448 0 448 23.552 448 52.736zm-72.96 242.688c0-82.432-36.864-149.248-36.864-149.248-36.864-27.648-71.936-26.88-71.936-26.88l-3.584 4.096c43.52 13.312 63.744 32.512 63.744 32.512-60.811-33.329-132.244-33.335-191.232-7.424-9.472 4.352-15.104 7.424-15.104 7.424s21.248-20.224 67.328-33.536l-2.56-3.072s-35.072-.768-71.936 26.88c0 0-36.864 66.816-36.864 149.248 0 0 21.504 37.12 78.08 38.912 0 0 9.472-11.52 17.152-21.248-32.512-9.728-44.8-30.208-44.8-30.208 3.766 2.636 9.976 6.053 10.496 6.4 43.21 24.198 104.588 32.126 159.744 8.96 8.96-3.328 18.944-8.192 29.44-15.104 0 0-12.8 20.992-46.336 30.464 7.68 9.728 16.896 20.736 16.896 20.736 56.576-1.792 78.336-38.912 78.336-38.912z"></path></svg></a></li><li class="m-3"><a class="link--white" href="https://twitter.com/801labs" rel="noopener" target="_blank" title="Twitter"><span class="sr-only">Twitter</span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter-square" class="svg-inline--fa fa-twitter-square fa-w-14 fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-48.9 158.8c.2 2.8.2 5.7.2 8.5 0 86.7-66 186.6-186.6 186.6-37.2 0-71.7-10.8-100.7-29.4 5.3.6 10.4.8 15.8.8 30.7 0 58.9-10.4 81.4-28-28.8-.6-53-19.5-61.3-45.5 10.1 1.5 19.2 1.5 29.6-1.2-30-6.1-52.5-32.5-52.5-64.4v-.8c8.7 4.9 18.9 7.9 29.6 8.3a65.447 65.447 0 0 1-29.2-54.6c0-12.2 3.2-23.4 8.9-33.1 32.3 39.8 80.8 65.8 135.2 68.6-9.3-44.5 24-80.6 64-80.6 18.9 0 35.9 7.9 47.9 20.7 14.8-2.8 29-8.3 41.6-15.8-4.9 15.2-15.2 28-28.8 36.1 13.2-1.4 26-5.1 37.8-10.2-8.9 13.1-20.1 24.7-32.9 34z"></path></svg></a></li><li class="m-3"><a class="link--white" href="https://www.youtube.com/c/801LabsSaltLakeCity" rel="noopener" target="_blank" title="YouTube"><span class="sr-only">YouTube</span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="youtube" class="svg-inline--fa fa-youtube fa-w-18 fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg></a></li><li class="m-3"><a class="link--white" href="https://slack.801labs.org/" rel="noopener" target="_blank" title="Slack"><span class="sr-only">Slack</span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="slack" class="svg-inline--fa fa-slack fa-w-14 fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"></path></svg></a></li><li class="m-3"><a class="link--white" href="https://github.com/801labs/" rel="noopener" target="_blank" title="GitHub"><span class="sr-only">GitHub</span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16 fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li class="m-3"><a class="link--white" href="https://fb.me/801labs" rel="noopener" target="_blank" title="Facebook"><span class="sr-only">Facebook</span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook-square" class="svg-inline--fa fa-facebook-square fa-w-14 fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h137.25V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.27c-30.81 0-40.42 19.12-40.42 38.73V256h68.78l-11 71.69h-57.78V480H400a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48z"></path></svg></a></li></ul><div class="grid grid-cols-2 lg:grid-cols-4 gap-5 mb-10"><div><h2 class="mb-4 fluid-text-lg uppercase"><a class="link--white" href="/about/">About</a></h2><ul class="space-y-2"><li><a class="link--white" href="/about/financial-information/">Financial Information</a></li><li><a class="link--white" href="/about/news/1/">News</a></li></ul></div><div><h2 class="mb-4 fluid-text-lg uppercase"><a class="link--white" href="/research-portal/1/">Learn</a></h2></div><div><h2 class="mb-4 fluid-text-lg uppercase"><a class="link--white" href="/get-involved/">Get Involved</a></h2><ul class="space-y-2"><li><a class="link--white" href="/get-involved/events/">Events</a></li><li><a class="link--white" href="/get-involved/location-and-hours/">Location and Hours</a></li></ul></div><div><h2 class="mb-4 fluid-text-lg uppercase"><a class="link--white" href="/contact/">Contact Us</a></h2></div></div><div class="border-t border-white fluid-text-sm text-center pt-10 space-y-5"><p>Â© <!-- -->2021<!-- --> 801Labs.com. All rights reserved.</p><p><a class="link--tangerine uppercase" href="/donate/">DonateÂ &gt;</a></p><p>801 Labs hackerspace is a 501(c)(3) that is open to the public!<br/>353 East 200 South Suite #B, Salt Lake City, UT 84111</p><p><a class="link--tangerine" href="/code-of-conduct/">Code of Conduct</a><span class="mx-3">|</span><a class="link--tangerine" href="/terms/">Terms</a></p></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"allTags":{"biohacking":"biohacking","buffer-overflow":"buffer overflow","development":"Development","dll-injection":"DLL Injection","domains":"domains","ee":"EE","example":"example","how-to":"how to","makefile":"Makefile","memory":"memory","pcap":"pcap","phishing":"phishing","re":"RE","research":"research","rfid":"RFID","story":"Story","windows-api":"Windows API","windows-hacking":"Windows Hacking"},"title":"DLL injection - Developing a simple injector.","slug":"developing-a-dll-injector","date_published":1549513920000,"date_updated":1562884307000,"tags":["how to","DLL Injection","Windows Hacking","Development","memory","Windows API"],"excerpt":"\n[DLL injection](https://en.wikipedia.org/wiki/DLL_injection) is the process of forcing a running process to load a DLL (Dynamically Linked Library) of your choice. In this write-up, I'll walk you through the LoadLibraryA injection method. This causes the DLL to be loaded into the context of the process thus allowing us to execute our own code inside of the process's virtual memory space.\n\n\tI assume there is a base understanding of what a DLL is. By the end of this write-up, we'll have a functional DLL injector along with a bare-bone test DLL which we'll use for testing during development.\n\n\tWriting a DLL injector is pretty trivial and only requires a handful steps. Remember that DLLs are specific to Windows and there-for we'll be utilizing functions provided to us by the Windows API. The steps required for the task at hand are in order as follows:\n\n1. Acquire a handle to the remote process that you want to inject / load your DLL into. We do this by prompting for a process ID (PID) after displaying a list of processes w/ their PIDs.\n\n\n    // Get the remote target pid\n    uint16_t target_pid = get_target_pid();\n    \n    if (!target_pid) {\n    std::cerr \u003c\u003c \"Getting remote target process ID failed...\" \u003c\u003c std::endl;\n    return 1;\n    }\n    \n    // \u003csnipped\u003e ...\n    \n    // Obtain a handle to the target remote process.\n    HANDLE target_process = OpenProcess(PROCESS_ALL_ACCESS, FALSE, target_pid);\n    \n    \n    if (target_process == NULL) {\n        std::cerr \u003c\u003c \"Acquiring a handle to the remote target process failed...\" \u003c\u003c std::endl;\n        return -1;\n    }\n\n*get_target_pid() function:*\n\n    \n    uint16_t get_target_pid() {\n    \tuint16_t pid = 0;\n    \t\n    \tstd::string pid_str;\n    \tbool first_input_entered = false;\n    \n    \tdo {\n    \t\tif (first_input_entered) {\n    \t\t\tsystem(\"cls\");\n    \t\t\tprint_banner();\n    \t\t\tstd::cerr \u003c\u003c \"The given process ID is invalid, try again...\" \u003c\u003c std::endl;\n    \t\t}\n    \n    \t\tprint_process_list();\n    \n    \t\tstd::cout \u003c\u003c \"\\nEnter target process ID: \";\n    \t\tstd::getline(std::cin, pid_str);\n    \n    \t\tif (first_input_entered == false) {\n    \t\t\tfirst_input_entered = true;\n    \t\t}\n    \n    \t\tif (pid_str == \"exit\" ||\n    \t\t\tpid_str == \"quit\") {\n    \t\t\tbreak;\n    \t\t}\n    \n    \t} while (file_exists(pid_str) == false \u0026\u0026 !pid_str.size());\n    \n    \tif (pid_str != \"exit\" \u0026\u0026\n    \t\tpid_str != \"quit\") {\n    \t\tpid = (uint16_t)std::stoi(pid_str);\n    \t}\n    \n    \treturn pid;\n    }\n\n2. Create and store the DLL's absolute path in a variable.\n\n\n    // Get the dll's path that we want to inject into our remote target process.\n    std::string dll_path = get_dll_path();\n    \n    std::cout \u003c\u003c \"DLL path: \" \u003c\u003c dll_path \u003c\u003c std::endl;\n\n*get_dll_path() function:*\n\n    std::string get_dll_path() {\n    \n    \tstd::string dll_path;\n    \tbool first_input_entered = false;\n    \n    \tdo {\n    \t\tif (first_input_entered) {\n    \t\t\tsystem(\"cls\");\n    \t\t\tprint_banner();\n    \t\t\tstd::cerr \u003c\u003c \"Specified DLL path was invalid, try again...\" \u003c\u003c std::endl;\n    \t\t}\n    \n    \t\tstd::cout \u003c\u003c \"Enter path to DLL: \";\n    \t\tstd::getline(std::cin, dll_path);\n    \n    \t\tif (first_input_entered == false) {\n    \t\t\tfirst_input_entered = true;\n    \t\t}\n    \n    \t\tif (dll_path == \"exit\" ||\n    \t\t\tdll_path == \"quit\") {\n    \t\t\tbreak;\n    \t\t}\n    \n    \t} while (file_exists(dll_path) == false);\n    \n    \treturn dll_path;\n    }\n\n3. Now we need to allocate enough space in the remote process to store the DLLs absolute path. We achieve this by using Window's [VirtualAllocEx](https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualallocex) function.\n\n\n    // Allocate space for our DLL path inside the target remote process.\n    LPVOID dll_path_in_remote_mem_addr = VirtualAllocEx(\n    \ttarget_process,\n    \tNULL,\n    \t_MAX_PATH,\n    \tMEM_RESERVE | MEM_COMMIT,\n    \tPAGE_EXECUTE_READWRITE\n    );\n    \n    if (dll_path_in_remote_mem_addr == NULL) {\n    \tstd::cerr \u003c\u003c \"Allocating space for our DLL path in the remote target process's virtual memory space failed...\" \u003c\u003c std::endl;\n    \tCloseHandle(target_process);\n    \treturn 1;\n    }\n    \n    std::cout \u003c\u003c \"DLL allocation memory address: \" \u003c\u003c \u0026dll_path_in_remote_mem_addr \u003c\u003c std::endl;\n\n4. And now that we've allocated and reserved enough memory for the DLL path, we can write it into that region of memory of the remote process using the Window's [WriteProcessMemory](https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-writeprocessmemory) function. \n\n\n    // Copy the DLL path into the allocated memory region.\n    bool write_status = WriteProcessMemory(\n    \ttarget_process,\n    \tdll_path_in_remote_mem_addr,\n    \tdll_path.c_str(),\n    \tstrlen(dll_path.c_str()),\n    \tNULL\n    );\n    \n    std::cout \u003c\u003c \"WriteProcessMemory was \" \u003c\u003c (write_status ? \"successful!\" : \"unsuccessful...\") \u003c\u003c std::endl;;\n    \n    if (!write_status) {\n    \tstd::cerr \u003c\u003c \"GetLastError() for failed WriteProcessMemory() call: \" \u003c\u003c GetLastError() \u003c\u003c std::endl;\n    \tCloseHandle(target_process);\n    \treturn 1;\n    }\n\n5. Next, we'll need to obtain the address to the Window's [LoadLibraryA](https://docs.microsoft.com/en-us/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function. This is easily done through the Window's [GetProcAddress](https://docs.microsoft.com/en-us/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) function.\n\n\n    // Get the address to the LoadLibraryA Windows API function.\n    LPVOID load_library_addr = (LPVOID)GetProcAddress(\n    \tGetModuleHandle(\"kernel32.dll\"),\n    \t\"LoadLibraryA\"\n    );\n    \n    if (load_library_addr == NULL) {\n    \tstd::cerr \u003c\u003c \"GetProcAddress failed...\" \u003c\u003c std::endl;\n    \tCloseHandle(target_process);\n    \treturn 1;\n    }\n    \n    std::cout \u003c\u003c \"LoadLibraryA address: \" \u003c\u003c \u0026load_library_addr \u003c\u003c std::endl;\n\n6. Create a remote thread via [CreateRemoteThread](https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createremotethread) and pass the handle we have on the remote process, the address to LoadLibraryA, and the memory address that our DLL path resides at. LoadLibraryA will be invoked and passed `dll_path_in_remote_mem_addr` by our call to CreateRemoteThread. This is where the magic happens and our DLL is loaded into the process.\n\n\n    // Create our remote thread for running our DLL code.\n    HANDLE remote_thread = CreateRemoteThread(\n    \ttarget_process,\n    \tNULL,\n    \tNULL,\n    \t(LPTHREAD_START_ROUTINE)load_library_addr,\n    \tdll_path_in_remote_mem_addr,\n    \tNULL,\n    \tNULL\n    );\n    \n    if (remote_thread == NULL) {\n    \tstd::cerr \u003c\u003c \"CreateRemoteThread failed...\" \u003c\u003c std::endl;\n    \treturn 1;\n    }\n    \n    std::cout \u003c\u003c \"Remote thread address: \" \u003c\u003c \u0026remote_thread \u003c\u003c std::endl;\n\n7. The last thing we do is deallocate the memory that was reserved for our DLL path using [VirtualFreeEx](https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualfreeex) and then close our open handles using [CloseHandle](https://docs.microsoft.com/en-us/windows/desktop/api/handleapi/nf-handleapi-closehandle).\n\n\n    // Release the allocated memory we acquired from the remote process.\n    if (VirtualFreeEx(target_process, dll_path_in_remote_mem_addr, 0, MEM_RELEASE) == 0) {\n    \tstd::cerr \u003c\u003c \"VirtualFreeEx failed on target process...\" \u003c\u003c std::endl;\n    }\n    \n    // Free our handle on the remote thread\n    CloseHandle(remote_thread);\n    \n    // Free our handle on the remote process\n    CloseHandle(target_process);\n\nTying our code together and testing it out ~ we run `.\\InjectDLL.exe`, then enter the remote target PID, and finally the absolute path to `TestDLL.dll`. Our executable outputs some information about the injection indicating it was successful. Â \n\n![](2019/07/2019-05-02-090559_3440x1440_scrot.png \"Successful execution of our DLL injector\")\n\nOur injector indicated it was successful, but we can double check with Window's [Process Explorer](https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer). After installing it (if you don't have it installed already) we launch it, make sure the lower pane is visible by toggling it on. This can be achieved by checking the `View -\u003e Show Lower Pane` option. Then, select the remote target process in the list and press the key combination `Ctrl + d`. You should now see a list of loaded DLLs. One of which is our DLL! \n\n![](2019/07/process-explorer-test-dll-injection-success.png \"Using Process Explorer, we can see that our TestDLL.dll file was injected into Game.exe successfully.\")\n\nOnce we have successfully loaded our DLL into the target process, we can access and reference anything within it's virtual memory space. In part 2, I'll demonstrate an example use case of DLL injection by showing how we can find an in-memory data structure (i.e. the offset to a player structure / class in a game).\n\nThe full source code for both the DLL injector and the Test DLL can be found in this [Github](https://github.com/selftaught/DLLinjector) repository.\n\nThanks for reading through this article! If you notice any issues in the write-up or code - please don't hesitate to message me! You can do so via [keybase](https://keybase.io/th3v0id) or [twitter](https://twitter.com/x74x76).\n","cover":"2019/07/process-explorer-test-dll-injection-success.png","author":{"name":"th3v0id","avatar":"avatars/th3v0id.jpg"},"content":"\u003cp\u003e\u003ca href=\"https://en.wikipedia.org/wiki/DLL_injection\"\u003eDLL injection\u003c/a\u003e is the process of forcing a running process to load a DLL (Dynamically Linked Library) of your choice. In this write-up, I'll walk you through the LoadLibraryA injection method. This causes the DLL to be loaded into the context of the process thus allowing us to execute our own code inside of the process's virtual memory space.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eI assume there is a base understanding of what a DLL is. By the end of this write-up, we'll have a functional DLL injector along with a bare-bone test DLL which we'll use for testing during development.\n\nWriting a DLL injector is pretty trivial and only requires a handful steps. Remember that DLLs are specific to Windows and there-for we'll be utilizing functions provided to us by the Windows API. The steps required for the task at hand are in order as follows:\n\u003c/code\u003e\u003c/pre\u003e\n\u003col\u003e\n\u003cli\u003eAcquire a handle to the remote process that you want to inject / load your DLL into. We do this by prompting for a process ID (PID) after displaying a list of processes w/ their PIDs.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003e// Get the remote target pid\nuint16_t target_pid = get_target_pid();\n\nif (!target_pid) {\nstd::cerr \u0026#x3C;\u0026#x3C; \"Getting remote target process ID failed...\" \u0026#x3C;\u0026#x3C; std::endl;\nreturn 1;\n}\n\n// \u0026#x3C;snipped\u003e ...\n\n// Obtain a handle to the target remote process.\nHANDLE target_process = OpenProcess(PROCESS_ALL_ACCESS, FALSE, target_pid);\n\n\nif (target_process == NULL) {\n    std::cerr \u0026#x3C;\u0026#x3C; \"Acquiring a handle to the remote target process failed...\" \u0026#x3C;\u0026#x3C; std::endl;\n    return -1;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cem\u003eget_target_pid() function:\u003c/em\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003euint16_t get_target_pid() {\n    uint16_t pid = 0;\n    \n    std::string pid_str;\n    bool first_input_entered = false;\n\n    do {\n        if (first_input_entered) {\n            system(\"cls\");\n            print_banner();\n            std::cerr \u0026#x3C;\u0026#x3C; \"The given process ID is invalid, try again...\" \u0026#x3C;\u0026#x3C; std::endl;\n        }\n\n        print_process_list();\n\n        std::cout \u0026#x3C;\u0026#x3C; \"\\nEnter target process ID: \";\n        std::getline(std::cin, pid_str);\n\n        if (first_input_entered == false) {\n            first_input_entered = true;\n        }\n\n        if (pid_str == \"exit\" ||\n            pid_str == \"quit\") {\n            break;\n        }\n\n    } while (file_exists(pid_str) == false \u0026#x26;\u0026#x26; !pid_str.size());\n\n    if (pid_str != \"exit\" \u0026#x26;\u0026#x26;\n        pid_str != \"quit\") {\n        pid = (uint16_t)std::stoi(pid_str);\n    }\n\n    return pid;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eCreate and store the DLL's absolute path in a variable.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003e// Get the dll's path that we want to inject into our remote target process.\nstd::string dll_path = get_dll_path();\n\nstd::cout \u0026#x3C;\u0026#x3C; \"DLL path: \" \u0026#x3C;\u0026#x3C; dll_path \u0026#x3C;\u0026#x3C; std::endl;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cem\u003eget_dll_path() function:\u003c/em\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003estd::string get_dll_path() {\n\n    std::string dll_path;\n    bool first_input_entered = false;\n\n    do {\n        if (first_input_entered) {\n            system(\"cls\");\n            print_banner();\n            std::cerr \u0026#x3C;\u0026#x3C; \"Specified DLL path was invalid, try again...\" \u0026#x3C;\u0026#x3C; std::endl;\n        }\n\n        std::cout \u0026#x3C;\u0026#x3C; \"Enter path to DLL: \";\n        std::getline(std::cin, dll_path);\n\n        if (first_input_entered == false) {\n            first_input_entered = true;\n        }\n\n        if (dll_path == \"exit\" ||\n            dll_path == \"quit\") {\n            break;\n        }\n\n    } while (file_exists(dll_path) == false);\n\n    return dll_path;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003eNow we need to allocate enough space in the remote process to store the DLLs absolute path. We achieve this by using Window's \u003ca href=\"https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualallocex\"\u003eVirtualAllocEx\u003c/a\u003e function.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003e// Allocate space for our DLL path inside the target remote process.\nLPVOID dll_path_in_remote_mem_addr = VirtualAllocEx(\n    target_process,\n    NULL,\n    _MAX_PATH,\n    MEM_RESERVE | MEM_COMMIT,\n    PAGE_EXECUTE_READWRITE\n);\n\nif (dll_path_in_remote_mem_addr == NULL) {\n    std::cerr \u0026#x3C;\u0026#x3C; \"Allocating space for our DLL path in the remote target process's virtual memory space failed...\" \u0026#x3C;\u0026#x3C; std::endl;\n    CloseHandle(target_process);\n    return 1;\n}\n\nstd::cout \u0026#x3C;\u0026#x3C; \"DLL allocation memory address: \" \u0026#x3C;\u0026#x3C; \u0026#x26;dll_path_in_remote_mem_addr \u0026#x3C;\u0026#x3C; std::endl;\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003eAnd now that we've allocated and reserved enough memory for the DLL path, we can write it into that region of memory of the remote process using the Window's \u003ca href=\"https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-writeprocessmemory\"\u003eWriteProcessMemory\u003c/a\u003e function. \u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003e// Copy the DLL path into the allocated memory region.\nbool write_status = WriteProcessMemory(\n    target_process,\n    dll_path_in_remote_mem_addr,\n    dll_path.c_str(),\n    strlen(dll_path.c_str()),\n    NULL\n);\n\nstd::cout \u0026#x3C;\u0026#x3C; \"WriteProcessMemory was \" \u0026#x3C;\u0026#x3C; (write_status ? \"successful!\" : \"unsuccessful...\") \u0026#x3C;\u0026#x3C; std::endl;;\n\nif (!write_status) {\n    std::cerr \u0026#x3C;\u0026#x3C; \"GetLastError() for failed WriteProcessMemory() call: \" \u0026#x3C;\u0026#x3C; GetLastError() \u0026#x3C;\u0026#x3C; std::endl;\n    CloseHandle(target_process);\n    return 1;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"5\"\u003e\n\u003cli\u003eNext, we'll need to obtain the address to the Window's \u003ca href=\"https://docs.microsoft.com/en-us/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya\"\u003eLoadLibraryA\u003c/a\u003e function. This is easily done through the Window's \u003ca href=\"https://docs.microsoft.com/en-us/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress\"\u003eGetProcAddress\u003c/a\u003e function.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003e// Get the address to the LoadLibraryA Windows API function.\nLPVOID load_library_addr = (LPVOID)GetProcAddress(\n    GetModuleHandle(\"kernel32.dll\"),\n    \"LoadLibraryA\"\n);\n\nif (load_library_addr == NULL) {\n    std::cerr \u0026#x3C;\u0026#x3C; \"GetProcAddress failed...\" \u0026#x3C;\u0026#x3C; std::endl;\n    CloseHandle(target_process);\n    return 1;\n}\n\nstd::cout \u0026#x3C;\u0026#x3C; \"LoadLibraryA address: \" \u0026#x3C;\u0026#x3C; \u0026#x26;load_library_addr \u0026#x3C;\u0026#x3C; std::endl;\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"6\"\u003e\n\u003cli\u003eCreate a remote thread via \u003ca href=\"https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createremotethread\"\u003eCreateRemoteThread\u003c/a\u003e and pass the handle we have on the remote process, the address to LoadLibraryA, and the memory address that our DLL path resides at. LoadLibraryA will be invoked and passed \u003ccode\u003edll_path_in_remote_mem_addr\u003c/code\u003e by our call to CreateRemoteThread. This is where the magic happens and our DLL is loaded into the process.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003e// Create our remote thread for running our DLL code.\nHANDLE remote_thread = CreateRemoteThread(\n    target_process,\n    NULL,\n    NULL,\n    (LPTHREAD_START_ROUTINE)load_library_addr,\n    dll_path_in_remote_mem_addr,\n    NULL,\n    NULL\n);\n\nif (remote_thread == NULL) {\n    std::cerr \u0026#x3C;\u0026#x3C; \"CreateRemoteThread failed...\" \u0026#x3C;\u0026#x3C; std::endl;\n    return 1;\n}\n\nstd::cout \u0026#x3C;\u0026#x3C; \"Remote thread address: \" \u0026#x3C;\u0026#x3C; \u0026#x26;remote_thread \u0026#x3C;\u0026#x3C; std::endl;\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"7\"\u003e\n\u003cli\u003eThe last thing we do is deallocate the memory that was reserved for our DLL path using \u003ca href=\"https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualfreeex\"\u003eVirtualFreeEx\u003c/a\u003e and then close our open handles using \u003ca href=\"https://docs.microsoft.com/en-us/windows/desktop/api/handleapi/nf-handleapi-closehandle\"\u003eCloseHandle\u003c/a\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003e// Release the allocated memory we acquired from the remote process.\nif (VirtualFreeEx(target_process, dll_path_in_remote_mem_addr, 0, MEM_RELEASE) == 0) {\n    std::cerr \u0026#x3C;\u0026#x3C; \"VirtualFreeEx failed on target process...\" \u0026#x3C;\u0026#x3C; std::endl;\n}\n\n// Free our handle on the remote thread\nCloseHandle(remote_thread);\n\n// Free our handle on the remote process\nCloseHandle(target_process);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTying our code together and testing it out ~ we run \u003ccode\u003e.\\InjectDLL.exe\u003c/code\u003e, then enter the remote target PID, and finally the absolute path to \u003ccode\u003eTestDLL.dll\u003c/code\u003e. Our executable outputs some information about the injection indicating it was successful. Â \u003c/p\u003e\n\u003cfigure\u003e\u003cimg src=\"/_next/static/images/2019-05-02-090559_3440x1440_scrot-320-74045b2d21363f7d7b94d37e5fb53583.png\" srcset=\"/_next/static/images/2019-05-02-090559_3440x1440_scrot-320-74045b2d21363f7d7b94d37e5fb53583.png 320w,/_next/static/images/2019-05-02-090559_3440x1440_scrot-640-df94f6e33fddaea1d71f1c60adbdd6d0.png 640w,/_next/static/images/2019-05-02-090559_3440x1440_scrot-858-3205627f11b561f2c89b5a4764c65e8d.png 858w\" sizes=\"(min-width: 960px) 960px, 100vw\" width=\"858\" height=\"652\" alt=\"undefined\" loading=\"lazy\" /\u003e\u003cfigcaption\u003eSuccessful execution of our DLL injector\u003c/figcaption\u003e\u003c/figure\u003e\n\u003cp\u003eOur injector indicated it was successful, but we can double check with Window's \u003ca href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer\"\u003eProcess Explorer\u003c/a\u003e. After installing it (if you don't have it installed already) we launch it, make sure the lower pane is visible by toggling it on. This can be achieved by checking the \u003ccode\u003eView -\u003e Show Lower Pane\u003c/code\u003e option. Then, select the remote target process in the list and press the key combination \u003ccode\u003eCtrl + d\u003c/code\u003e. You should now see a list of loaded DLLs. One of which is our DLL! \u003c/p\u003e\n\u003cfigure\u003e\u003cimg src=\"/_next/static/images/process-explorer-test-dll-injection-success-320-4c3ea14f721f498145f270602b4fb293.png\" srcset=\"/_next/static/images/process-explorer-test-dll-injection-success-320-4c3ea14f721f498145f270602b4fb293.png 320w,/_next/static/images/process-explorer-test-dll-injection-success-640-ccf24fee1f07f598aa51e21babc83f48.png 640w,/_next/static/images/process-explorer-test-dll-injection-success-787-24f050b26483fbdde8070ee31259b7d5.png 787w\" sizes=\"(min-width: 960px) 960px, 100vw\" width=\"787\" height=\"586\" alt=\"undefined\" loading=\"lazy\" /\u003e\u003cfigcaption\u003eUsing Process Explorer, we can see that our TestDLL.dll file was injected into Game.exe successfully.\u003c/figcaption\u003e\u003c/figure\u003e\n\u003cp\u003eOnce we have successfully loaded our DLL into the target process, we can access and reference anything within it's virtual memory space. In part 2, I'll demonstrate an example use case of DLL injection by showing how we can find an in-memory data structure (i.e. the offset to a player structure / class in a game).\u003c/p\u003e\n\u003cp\u003eThe full source code for both the DLL injector and the Test DLL can be found in this \u003ca href=\"https://github.com/selftaught/DLLinjector\"\u003eGithub\u003c/a\u003e repository.\u003c/p\u003e\n\u003cp\u003eThanks for reading through this article! If you notice any issues in the write-up or code - please don't hesitate to message me! You can do so via \u003ca href=\"https://keybase.io/th3v0id\"\u003ekeybase\u003c/a\u003e or \u003ca href=\"https://twitter.com/x74x76\"\u003etwitter\u003c/a\u003e.\u003c/p\u003e\n"},"__N_SSG":true},"page":"/research-portal/post/[slug]","query":{"slug":"developing-a-dll-injector"},"buildId":"FvcvUPYOiSvtvIbGA81wj","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-8aa29ccfa5f6c93452ea.js"></script><script src="/_next/static/chunks/main-b4e92501dafbf3105fc2.js" async=""></script><script src="/_next/static/chunks/webpack-488dc228921f1fdbc0e7.js" async=""></script><script src="/_next/static/chunks/framework.639a4c6d2372edf94622.js" async=""></script><script src="/_next/static/chunks/commons.4d1825a506d17b0928b0.js" async=""></script><script src="/_next/static/chunks/pages/_app-badc504270fd7076183e.js" async=""></script><script src="/_next/static/chunks/cb1608f2.7e132185cf1e34346bef.js" async=""></script><script src="/_next/static/chunks/a9a7754c.d19ee79fa77cd467a6a8.js" async=""></script><script src="/_next/static/chunks/d08d8da065e662efb4cb4dbcdc52896f9ea60d65.0dcfe3fd2994d62f05b2.js" async=""></script><script src="/_next/static/chunks/269ea3ef5216fdb5e29fe1b24ee03a8936e3d31a.2c1f7a57d2a5886c4934.js" async=""></script><script src="/_next/static/chunks/pages/research-portal/post/%5Bslug%5D-4f135702a487b59705c4.js" async=""></script><script src="/_next/static/FvcvUPYOiSvtvIbGA81wj/_buildManifest.js" async=""></script><script src="/_next/static/FvcvUPYOiSvtvIbGA81wj/_ssgManifest.js" async=""></script></body></html>